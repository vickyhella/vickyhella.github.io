"use strict";(self.webpackChunkvickyhella_github_io=self.webpackChunkvickyhella_github_io||[]).push([[5327],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return h}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,h=u["".concat(p,".").concat(m)]||u[m]||d[m]||o;return n?r.createElement(h,i(i({ref:t},l),{},{components:n})):r.createElement(h,i({ref:t},l))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4235:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return i},default:function(){return d},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return c}});var r=n(3117),a=(n(7294),n(3905));const o={title:"Updating API Docs"},i=void 0,s={unversionedId:"docusaurus/api-docs",id:"docusaurus/api-docs",title:"Updating API Docs",description:"Currently, two Harvester versions, v1.1 and v1.2, have API docs. They are already well-configured. However, if you need to add API docs for another version, such as v1.3, follow the instructions below.",source:"@site/docs/docusaurus/api-docs.md",sourceDirName:"docusaurus",slug:"/docusaurus/api-docs",permalink:"/docs/docusaurus/api-docs",draft:!1,editUrl:"https://github.com/vickyhella/vickyhella.github.io/edit/main/docs/docusaurus/api-docs.md",tags:[],version:"current",lastUpdatedBy:"vickyhella",lastUpdatedAt:1696820141,formattedLastUpdatedAt:"Oct 9, 2023",frontMatter:{title:"Updating API Docs"},sidebar:"tutorialSidebar",previous:{title:"Hiding Pages",permalink:"/docs/docusaurus/hiding-pages"},next:{title:"Using Multiple Sidebars in Docusaurus",permalink:"/docs/pages-from-docs-team/multi-sidebar"}},p={},c=[],l={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Currently, two Harvester versions, v1.1 and v1.2, have API docs. They are already well-configured. However, if you need to add API docs for another version, such as v1.3, follow the instructions below."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Click ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/harvester/harvester/tree/master/api/openapi-spec"},"this link"),", select the desired branch (e.g., v1.3), and download the ",(0,a.kt)("inlineCode",{parentName:"p"},"swagger.json")," file that is needed. You can also confirm with a backend engineer to make sure you are using the right ",(0,a.kt)("inlineCode",{parentName:"p"},"swagger.json")," file.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Copy the paste the file downloaded above to the ",(0,a.kt)("inlineCode",{parentName:"p"},"api")," folder of the Harvester documentation repo, and rename it ",(0,a.kt)("inlineCode",{parentName:"p"},"v1.3-swagger.json"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Open the ",(0,a.kt)("inlineCode",{parentName:"p"},"docusaurus.config.js")," file and modify the OpenAPI configurations as follows:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},'    [\n    "docusaurus-plugin-openapi-docs",\n    {\n      id: "api",\n      docsPluginId: "classic",\n      config: {\n        api: {\n          specPath: "api/v1.3-swagger.json", // path of the v1.3-swagger.json\n          outputDir: "docs/api",\n          sidebarOptions: {\n            groupPathsBy: "tag",\n            categoryLinkSource: "tag",\n          },\n          version: "v1.3", // Set v1.3 as the current version\n          label: "v1.3", // Current version label\n          baseUrl: "/v1.3/api", // Leading slash is important\n          versions: {\n            "v1.2": { // add v1.2 to the versions part\n              specPath: "api/v1.2-swagger.json",\n              outputDir: "versioned_docs/version-v1.2/api",\n              label: "v1.2",\n              baseUrl: "/v1.2/api",\n            },\n            "v1.1": {\n              specPath: "api/v1.1-swagger.json",\n              outputDir: "versioned_docs/version-v1.1/api",\n              label: "v1.1",\n              baseUrl: "/v1.1/api",\n            },\n          },\n        },\n      },\n    },\n  ],\n'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"After updating ",(0,a.kt)("inlineCode",{parentName:"p"},"docusaurus.config.js"),", run the command below:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn clean-api-docs && yarn gen-api-docs\n")),(0,a.kt)("p",{parentName:"li"},"This command clears all API mdx files and regenerates them according to the configurations made in step 3.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"After running the command, you might see the ",(0,a.kt)("inlineCode",{parentName:"p"},"harvester-apis.info.mdx")," file of each version is changed because one sentence is deleted after the command is run. This is because this line was manually added in the first place and thus is removed every time this command is run.\nTherefore, you need to add this sentence back to the files for each version after you run the command."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"This section introduces the APIs of the Harvester server. You can find out more about Harvester's API definitions [here](https://github.com/harvester/harvester/tree/master/pkg/apis/harvesterhci.io).\n")),(0,a.kt)("p",{parentName:"li"},"  This sentence is the content of the ",(0,a.kt)("inlineCode",{parentName:"p"},"API - Introduction")," page. If you miss this step, this page will be empty and have no content at all.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Verify it in a local environment to see if your configurations are looking good in production:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn start\n")),(0,a.kt)("p",{parentName:"li"},"An even better way to verify it is to build it locally. ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn build")," can report errors for both the ",(0,a.kt)("inlineCode",{parentName:"p"},"zh")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"en")," locales."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn build\nyarn serve\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"After everything is done, commit your changes and submit a PR. If no error is reported in the CI, reviewers can safely merge your PRs after their review."),(0,a.kt)("admonition",{parentName:"li",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"If the CI reports an error similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"JavaScript heap out of memory")," after you add the v1.3 API docs, but ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn build")," was successful on your local machine, that is because the machine our CI is using doesn't have enough memory."),(0,a.kt)("p",{parentName:"admonition"},"In this case, you might need to reach out to an engineer for help with the machine or CI configurations.")))))}d.isMDXComponent=!0}}]);